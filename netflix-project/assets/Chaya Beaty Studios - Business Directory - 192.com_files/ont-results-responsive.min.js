
(function($,window,document,undefined){var visibleItemsKey='';var topBound,bottomBound;var map_debug=false;var controller_debug=false;var mapApp=$('#mapApp');function isInBound(el){var cr=el.getBoundingClientRect();return(cr.top<bottomBound&&cr.top>topBound)||((cr.top+cr.height)<bottomBound&&(cr.top+cr.height)>topBound);}
function getVisibleResultsItems(){if(!$('#mapApp').is(':visible')){return{key:'',pois:[]};}
var container=null;if($('.ont-results-header').length){container=$('.ont-results-header')[0];}
else if($('#ont-top-section').length){container=$('#ont-top-section')[0];}
var cr=container.getBoundingClientRect();topBound=cr.top+cr.height;bottomBound=$('.js-ont-layout-sticky-footer')[0].getBoundingClientRect().top;if(bottomBound<topBound){bottomBound=$('#ont-result-content')[0].getBoundingClientRect().bottom;}
var key=[];var pois=[];$('.js-ont-gmap-record').each(function(i,el){if(pois.length<=20&&isInBound(el)){key.push(i+1);pois.push(el);}});return{key:key.join(','),pois:pois};}
function updateMapResults(isReset){if(isReset){visibleItemsKey='';}
var visibleItems=getVisibleResultsItems();if(visibleItems.key!=visibleItemsKey){visibleItemsKey=visibleItems.key;var pois=[];for(var i=0;i<visibleItems.pois.length;++i){pois.push(createPoi($(visibleItems.pois[i])));}
if(mapApp.ontGoogleMap&&mapApp.ontGoogleMap('getStatus')==='READY'){setTimeout(function(){mapApp.ontGoogleMap('setPois',pois);mapApp.ontGoogleMap('forceResize');mapApp.ontGoogleMap('zoomToFit');},50);}}}
var debug_log=function(){if(controller_debug&&typeof console!='undefined'){console.log('[MapController] '+arguments[0]);}};window.ontMap={exists:true,updateMapResults:updateMapResults,forceResize:function(){if(mapApp.ontGoogleMap('hasMap')){mapApp.ontGoogleMap('forceResize');}}};if(!mapApp.length){window.ontMap.exists=false;window.ontMap.updateMapResults=function(){};window.forceResize=function(){};debug_log('There is no #mapApp on the page');return;}
debug_log('INIT '+mapApp.data('page'));enablePoiHighlight();function displayRecords(){var pois=[];var container=$('.js-ont-gmap-recordset');container.find('.js-ont-gmap-record').each(function(i,el){if(i>20){return;}
var poi=createPoi($(el));if(poi.id){pois.push(poi);}});var mapOptions={DEBUG:map_debug,pois:pois,poiType:container.data('poi-type'),zoom:preferredZoomLevel(pois),mapTypeId:preferredMapType(pois)};mapApp.ontGoogleMap(mapOptions);}
function createPoi(record){var poi={id:record.data('record-id'),location:{gre:record.data('gre'),grn:record.data('grn')},title:record.data('title'),name:$.trim(record.data('name')).replace(/\s+/g,' '),detailsUrl:record.data('details-url')};var body=record.data('body');if(body){poi.body='<div class="ont-gmap-popup-address">';$.each(body.split(','),function(i,e){poi.body+='<p>'+$.trim(e)+'</p>';});poi.body+='</div>';}
if(poi.detailsUrl){poi.body+='<div class="ont-gmap-popup-details-link clearfix"><a href="'+poi.detailsUrl+'">details</a></div>';}
return poi;}
function preferredZoomLevel(pois){switch(mapApp.data('page')){case'places-search-results':if(pois.length===1){return 17;}
break;default:}
return undefined;}
function preferredMapType(pois){switch(mapApp.data('page')){case'places-search-results':if(pois.length===1){return'hybrid';}
break;case'multilocations':return'roadmap';default:}
return undefined;}
function enablePoiHighlight(){$(document).on('mouseenter mouseleave','.js-ont-gmap-recordset .js-ont-gmap-record',function(e){switch(e.type){case'mouseenter':mapApp.ontGoogleMap('highlightPoi',{highlighted:true,id:$(this).data('record-id')});break;case'mouseleave':mapApp.ontGoogleMap('highlightPoi',{highlighted:false,id:$(this).data('record-id')});break;}});mapApp.on('highlightPoi',function(event,poi){var id=poi.id;var isHighlighted=poi.highlighted;var item=$('.js-ont-gmap-record').filter(function(){return $(this).data('record-id')==id;});if(isHighlighted){item.addClass('ont-map-record-highlighted');}
else{item.removeClass('ont-map-record-highlighted');}});}
$(document).on('media-changed',function(){updateMapResults(true);});mapApp.on('map-rebuild',displayRecords);})(jQuery,window,document);"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||Object.prototype.toString.call(arr)==="[object Arguments]")){return;}var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var LOCATIONS_ID='7-0';var COLUMNS_BREAKING_POINT=1220;var HEIGHT_ADJUSTMENT={Age:{small:65,smaller:350},Surname:{small:65,smaller:310},Forename:{small:65,smaller:270},Location:{small:100,smaller:260}};var taxonomy={data:null,prevData:{},adjustLayout:function adjustLayout(){},forceTwoColumns:false,refresh:function refresh(){},updateColumnsCount:function updateColumnsCount(){if(taxonomy.forceTwoColumns&&$(window).innerWidth()>COLUMNS_BREAKING_POINT){taxonomy.forceTwoColumns=false;taxonomy.refresh();}
if(!taxonomy.forceTwoColumns&&$(window).innerWidth()<COLUMNS_BREAKING_POINT){taxonomy.forceTwoColumns=true;taxonomy.refresh();}},onTaxonomyComboOpen:function onTaxonomyComboOpen(){},onTaxonomyComboClose:function onTaxonomyComboClose(){},fetchSelected:function fetchSelected(){}};if(!Array.prototype.find){Object.defineProperty(Array.prototype,'find',{value:function value(predicate){if(this==null){throw new TypeError('"this" is null or not defined');}
var o=Object(this);var len=o.length>>>0;if(typeof predicate!=='function'){throw new TypeError('predicate must be a function');}
var thisArg=arguments[1];var k=0;while(k<len){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return kValue;}
k++;}
return undefined;}});}
function clone(object){return JSON.parse(JSON.stringify(object));}
function closeDeepNodes(){var collected=[];var depth=0;function collect(item){depth++;item.children.forEach(function(child){if(depth>2)collected.push(child);collect(child);});depth--;}
collect(taxonomy.data);collected.forEach(function(item){return item.opened=false;});}
function filter(what){what=what.toLowerCase().trim();var locationTaxonomy=taxonomy.data.children.find(function(item){return item.id===LOCATIONS_ID;});locationTaxonomy=clone(locationTaxonomy);locationTaxonomy.filterValue=what;locationTaxonomy.children.forEach(function(locItem){return locItem.filterValue=what;});if(!what.length){allChildren(locationTaxonomy).forEach(function(item){delete item.matched;delete item.filterValue;});delete locationTaxonomy.matched;taxonomy.data.children=taxonomy.data.children.map(function(child){return child.id===LOCATIONS_ID?locationTaxonomy:child;});return;}
function collect(item){item.children.forEach(function(child){child.matched=child.caption.toLowerCase().indexOf(what)!==-1;collect(child);});item.matched=item.matched||!!item.children.find(function(child){return child.matched;});}
collect(locationTaxonomy);taxonomy.data.children=taxonomy.data.children.map(function(child){return child.id===LOCATIONS_ID?locationTaxonomy:child;});}
function allChildren(root){var collected=[];function collect(item){item.children.forEach(function(child){collected.push(child);collect(child);});}
collect(root);return collected;}
function findItemWithChild(item,childKey,stack){stack.push(item);var itemFound=item.children.find(function(child){return child.id===childKey;});if(itemFound){stack.push(itemFound);return true;}
return item.children.some(function(childItem){if(findItemWithChild(childItem,childKey,stack)){return true;}
stack.pop(childItem);return false;});}
function findItem(id){var stack=[];taxonomy.data=clone(taxonomy.data);findItemWithChild(taxonomy.data,id,stack);return stack;}
function findAllSelected(){return allChildren(taxonomy.data).filter(function(item){return item.filtered;}).map(function(item){return item.id;});}
function useOutsideAlerter(what,ref,callback){function handleClickOutside(event){if(ref.current&&!ref.current.parentElement.contains(event.target)){callback();}}
React.useEffect(function(){document.addEventListener("mousedown",handleClickOutside);return function(){document.removeEventListener("mousedown",handleClickOutside);};});}
function Taxonomy(){var _React$useState=React.useState(taxonomy.data),_React$useState2=_slicedToArray(_React$useState,2),taxonomyData=_React$useState2[0],setTaxonomyData=_React$useState2[1];var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),refreshCount=_React$useState4[0],refresh=_React$useState4[1];if(!taxonomyData||!taxonomyData.children||!taxonomyData.children.length){return'No taxonomy';}
taxonomy.refresh=function(){refresh(refreshCount+1);};var onToggleTaxonomyItemOpened=function onToggleTaxonomyItemOpened(itemsData){var branch=findItem(itemsData.id);var item=branch[branch.length-1];item.opened=!item.opened;setTaxonomyData(taxonomy.data);};var onToggleTaxonomyItemFilter=function onToggleTaxonomyItemFilter(itemsData){var branch=findItem(itemsData.id);var item=branch.pop();item.filtered=!item.filtered;allChildren(item).forEach(function(item){return item.filtered=false;});branch.forEach(function(item){return item.filtered=false;});setTaxonomyData(taxonomy.data);};var onApplyFilter=function onApplyFilter(filterValue){filter(filterValue);taxonomy.data=Object.assign({},taxonomy.data);setTaxonomyData(taxonomy.data);};return React.createElement("div",{className:"swiper-wrapper",style:{overflow:'visible'}},taxonomyData.children.filter(function(taxonomyRoot){return taxonomyRoot.children&&taxonomyRoot.children.length;}).map(function(taxonomyRoot){return React.createElement(TaxonomyCombo,{key:taxonomyRoot.id,taxonomyData:taxonomyRoot,setTaxonomyData:setTaxonomyData,onToggleTaxonomyItemOpened:onToggleTaxonomyItemOpened,onToggleTaxonomyItemFilter:onToggleTaxonomyItemFilter,onApplyFilter:onApplyFilter});}));}
function TaxonomyCombo(props){var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isComboOpen=_React$useState6[0],setComboOpen=_React$useState6[1];var toggleCombo=function toggleCombo(){if(isComboOpen){var branch=findItem(props.taxonomyData.id);var item=branch[branch.length-1];item.children=taxonomy.prevData[props.taxonomyData.id].children;props.setTaxonomyData(taxonomy.data);taxonomy.onTaxonomyComboClose();}else{taxonomy.prevSelected=findAllSelected().sort();taxonomy.prevData[props.taxonomyData.id]=clone(props.taxonomyData);taxonomy.onTaxonomyComboOpen();}
taxonomy.updateColumnsCount();setComboOpen(!isComboOpen);props.onApplyFilter('');};var closeCombo=function closeCombo(){setComboOpen(false);props.onApplyFilter('');taxonomy.onTaxonomyComboClose();};var classNameCombo="taxonomyCombo swiper-slide";var classNameLabel="taxonomyComboLabel";var label=props.taxonomyData.caption;if(props.taxonomyData.filteredCount){classNameCombo+=' hasFilter';classNameLabel+=' hasFilter';label+=" (".concat(props.taxonomyData.filteredCount,")");}
if(isComboOpen){classNameCombo+=' opened';classNameLabel+=' opened';}
return React.createElement("div",{className:classNameCombo},React.createElement("div",{className:classNameLabel,onClick:toggleCombo},label),isComboOpen&&React.createElement(TaxonomyComboContent,_extends({toggleCombo:toggleCombo,closeCombo:closeCombo},props)));}
function FilterBox(props){var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),filterValue=_React$useState8[0],setFilterValue=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),focused=_React$useState10[0],setFocused=_React$useState10[1];var onChange=function onChange(e){setFilterValue(e.target.value);props.onApplyFilter(e.target.value);};var onBlur=function onBlur(){setFocused(false);};var onFocus=function onFocus(){setFocused(true);};var className="filterBox ".concat(focused?'focused':'');return React.createElement("div",{className:className},React.createElement("i",{className:"searchIcon"}),React.createElement("input",{onChange:onChange,onBlur:onBlur,onFocus:onFocus,value:filterValue,placeholder:"Search within results"}));}
function TaxonomyComboContent(props){var wrapperRef=React.useRef(null);React.useEffect(function(){var type=props.taxonomyData.caption;$(wrapperRef.current).addClass('open');var ww=$(window).width();var header=$(".ont-results-header").outerHeight(true);var promoBlock=$(".js-ont-product-promo").outerHeight(true);var creditCounter=$(".ont-credit-counter").outerHeight(true);var x=$(".ont-layout-section-content").offset();var resultsHeaderFixedContent=$(".ont-results-fixed-content").offset().top+$(".ont-results-fixed-content").outerHeight(true);if($(".js-ont-layout-sticky-footer").length){var footerHeight=$(".js-ont-layout-sticky-footer").outerHeight(true);}
if(ww>580){var vph=$(window).height()-resultsHeaderFixedContent-footerHeight-HEIGHT_ADJUSTMENT[type].small;$(wrapperRef.current).find('.taxonomyItemsWrapper').css({"maxHeight":vph+"px"});}else if(ww<=580){var _vph=$(window).height()-x.top-header-promoBlock-creditCounter-HEIGHT_ADJUSTMENT[type].smaller;$(wrapperRef.current).find('.taxonomyItemsWrapper').css({"maxHeight":_vph+"px"});}},[props.taxonomyData.caption]);useOutsideAlerter(props.taxonomyData.caption,wrapperRef,props.toggleCombo);var isPrevDataTheSame=findAllSelected().sort().toString()===taxonomy.prevSelected.toString();var clear=function clear(){var branch=findItem(props.taxonomyData.id);var item=branch[branch.length-1];allChildren(item).forEach(function(item){return item.filtered=false;});props.setTaxonomyData(taxonomy.data);};var apply=function apply(){props.closeCombo();var branch=findItem(props.taxonomyData.id);var item=branch[branch.length-1];item.filteredCount=allChildren(item).filter(function(item){return item.filtered;}).length;props.setTaxonomyData(taxonomy.data);var currentlySelected=findAllSelected();var toInclude=currentlySelected.filter(function(item){return taxonomy.prevSelected.indexOf(item)===-1;});var toExclude=taxonomy.prevSelected.filter(function(item){return currentlySelected.indexOf(item)===-1;});taxonomy.fetchSelected(toInclude,toExclude);};var comboId=props.taxonomyData.id;var applyClassName='btn save ont-btn-main';var comboClassName="taxonomyComboContent ".concat(props.taxonomyData.caption);if(isPrevDataTheSame){applyClassName+=' disabled';}
return React.createElement("div",{ref:wrapperRef,className:comboClassName},comboId===LOCATIONS_ID?React.createElement(FilterBox,props):null,React.createElement("div",{className:"taxonomyItemsWrapper"},React.createElement(TaxonomyItems,_extends({ident:0,comboId:comboId},props))),React.createElement("div",{className:"taxonomyItemsFooter clearfix"},React.createElement("div",{className:"btn clear",onClick:clear},"Clear"),React.createElement("div",{className:applyClassName,onClick:isPrevDataTheSame?function(){}:apply},"Apply")));}
function LocationItems(props){React.useEffect(taxonomy.adjustLayout,[]);var taxonomyData=props.taxonomyData,ident=props.ident;var columns=[];if(taxonomyData.children.length>2&&taxonomy.forceTwoColumns){var sortedByCount=taxonomyData.children.sort(function(a,b){return b.count-a.count;});columns[0]=[sortedByCount[0]];columns[2]=sortedByCount.slice(1,sortedByCount.length);}else if(taxonomyData.children.length>3){var _sortedByCount=taxonomyData.children.sort(function(a,b){return b.count-a.count;});columns[0]=[_sortedByCount[0]];columns[1]=[_sortedByCount[1]];columns[2]=_sortedByCount.slice(2,_sortedByCount.length);}else{columns=taxonomyData.children.map(function(c){return[c];});}
if(taxonomyData.matched){columns=columns.filter(function(column){return column.find(function(locationItem){return locationItem.matched;});});}
return React.createElement("div",{className:"taxonomyComboItemsWrapper"},columns.map(function(column){return React.createElement("div",{className:"taxonomyComboItemsTopLevel",key:column[0].id},column.map(function(childTaxonomyData){var childrenProps=_objectSpread({},props,{taxonomyData:childTaxonomyData,ident:ident+1});return React.createElement(TaxonomyItems,_extends({key:childTaxonomyData.id},childrenProps));}));}));}
function TaxonomyItems(props){var taxonomyData=props.taxonomyData,ident=props.ident,comboId=props.comboId;if(!taxonomyData.matched&&taxonomyData.filterValue){return null;}
if(ident===0&&comboId===LOCATIONS_ID){return React.createElement(LocationItems,props);}
var isOpened=taxonomyData.opened||taxonomyData.matched;return React.createElement(React.Fragment,null,ident?React.createElement(TaxonomyItem,_extends({key:taxonomyData.id},props)):null,!isOpened?null:taxonomyData.children.map(function(childTaxonomyData){var childrenProps=_objectSpread({},props,{taxonomyData:childTaxonomyData,ident:ident+1});return React.createElement(TaxonomyItems,_extends({key:childTaxonomyData.id},childrenProps));}));}
function TaxonomyItem(props){var taxonomyData=props.taxonomyData,ident=props.ident;if(taxonomyData.matched===false){return null;}
var className="taxonomyItem ident-".concat(ident);return React.createElement("div",{className:className},React.createElement(TaxonomyExpander,props),React.createElement(TaxonomyLabel,props),React.createElement(TaxonomyCheckbox,props));}
function TaxonomyExpander(_ref){var ident=_ref.ident,taxonomyData=_ref.taxonomyData,onToggleTaxonomyItemOpened=_ref.onToggleTaxonomyItemOpened;if(ident<=1){return null;}
var className="expander ".concat(taxonomyData.opened?'opened':''," ").concat(taxonomyData.leaf?'leaf':'');return React.createElement("span",{className:className,onClick:function onClick(){return onToggleTaxonomyItemOpened(taxonomyData);}});}
function TaxonomyCheckbox(_ref2){var taxonomyData=_ref2.taxonomyData,onToggleTaxonomyItemFilter=_ref2.onToggleTaxonomyItemFilter;if(!taxonomyData.filterable){return null;}
var className="checkbox ".concat(taxonomyData.filtered?'checked':'');if(taxonomyData.filtered){className+=' checked';}else if(allChildren(taxonomyData).find(function(item){return item.filtered;})){className+=' intermediate';}
return React.createElement("div",{className:className,onClick:function onClick(){return onToggleTaxonomyItemFilter(taxonomyData);}});}
function TaxonomyLabel(_ref3){var taxonomyData=_ref3.taxonomyData,onToggleTaxonomyItemFilter=_ref3.onToggleTaxonomyItemFilter;var className='label link';if(taxonomyData.filtered||allChildren(taxonomyData).find(function(item){return item.filtered;})){className+=' selected';}
return React.createElement("div",{className:className,onClick:function onClick(){return onToggleTaxonomyItemFilter(taxonomyData);}},taxonomyData.caption,React.createElement("span",{className:"count"},"\xA0(",taxonomyData.count,")"));}
function locationMark(loc){switch(loc){case'England':return 100;case'Scotland':return 90;case'Wales':return 80;case'Northern Ireland':return 70;case'United Kingdom':return 60;case'Unknown':return 0;default:return 20;}}
function locationsSorter(loc1,loc2){return locationMark(loc2.caption)-locationMark(loc1.caption);}
window.renderTaxonomy=function renderTaxonomy(data,adjustLayout){taxonomy.data=data;if(!data||!data.children){taxonomy.adjustLayout=function(){};$('.ont-taxonomy-wrapper').remove();return;}
taxonomy.adjustLayout=adjustLayout;var children=[];var locationsItem=data.children.find(function(item){return item.id===LOCATIONS_ID;});if(locationsItem){locationsItem.caption='Location';locationsItem.children.sort(locationsSorter);children.push(locationsItem);}
data.children.forEach(function(item){if(item.id!==LOCATIONS_ID){children.push(item);}});taxonomy.data.children=children;allChildren(taxonomy.data).forEach(function(item){if(item.caption==='Unknown'){item.children=[];}});closeDeepNodes();ReactDOM.render(React.createElement(Taxonomy,null),document.getElementById('taxonomy'));};$(window).resize(taxonomy.updateColumnsCount);$(document).ready(function(){$('.ont-accordion').on('click',function(){$(this).toggleClass('active');$('.ont-panel').toggleClass('show');});$(window).on('load resize',function(){var header=$('.ont-results-header').outerHeight(true);if(header>100){$('.ont-layout-section.inner-wrap').addClass('paddingLarge');}
else{$('.ont-layout-section.inner-wrap').removeClass('paddingLarge');}
var wwTaxonomy=$(window).width();if(wwTaxonomy<=768){$('.ont-layout-sticky-header').addClass('taxonomy');$('.taxonomyComboContent').removeClass('open');$('.ont-results-header').removeClass('ont-low-visibility');$('.ont-ul-results-list').removeClass('ont-low-visibility');$('.ont-people-results-left-section').removeClass('ont-low-visibility');$('.ont-people-results-right-section').removeClass('ont-low-visibility');$('body').removeClass('body-lock');$('.ont-layout-section-content').css({'position':'absolute'});$('.ont-panel').removeClass('show');$('.ont-accordion').removeClass('active');if($('.taxonomyCombo.opened')){$('.taxonomyComboLabel.opened').trigger('click');}}
else{$('.ont-layout-sticky-header').removeClass('taxonomy');}}).resize();taxonomy.onTaxonomyComboOpen=function onTaxonomyComboOpen(){$('.ont-results-header').addClass('ont-low-visibility');$('.ont-ul-results-list').addClass('ont-low-visibility');$('.ont-people-results-left-section').addClass('ont-low-visibility');$('.ont-people-results-right-section').addClass('ont-low-visibility');$('body').addClass('body-lock');};taxonomy.onTaxonomyComboClose=function onTaxonomyComboClose(){$('.ont-results-header').removeClass('ont-low-visibility');$('.ont-ul-results-list').removeClass('ont-low-visibility');$('.ont-people-results-left-section').removeClass('ont-low-visibility');$('.ont-people-results-right-section').removeClass('ont-low-visibility');$('body').removeClass('body-lock');};taxonomy.fetchSelected=function fetchSelected(toInclude,toExclude){var ul=$('<ul>').addClass('ont-ul-results-list');function addPlaceholder(widthPerc){if(!widthPerc){widthPerc=Math.floor(Math.random()*50)+40;}
let bar=$('<span class="ont-result-placeholder">').css({display:'block',width:widthPerc+'%',height:'20px',marginTop:'5px'});return bar[0].outerHTML;}
function creteRow(){var li=$('<li>').addClass('ont-people-premium-result-item');var wrap=$('<div class="ont-result-item-wrap">');li.append(wrap);var main=$('<div style="width: 100%;">');main.append('<span class="num" style="color: #f2f2f2;">#</span>');$('<div style="width: 100%;">').append('<div class="ont-results-item-name">'+addPlaceholder().replace('%','px')+'</div>').append('<div class="director">'+addPlaceholder().replace('%','px')+'</div>').append('<div class="address-tablet">'+addPlaceholder()+'</div>').append('<span class="arrow-right" style="opacity: 0.2"></span>').appendTo(main);wrap.append(main).append('<div class="results-address">'+addPlaceholder()+addPlaceholder()+'</div>').append('<div class="results-occupants">'+addPlaceholder()+addPlaceholder()+'</div>').append('<a class="test-details-link ont-btn-main ont-result-placeholder"><span class="desktop-text">&nbsp</span><span class="tablet-text">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></a>');return li;}
for(var i=0;i<20;++i){ul.append(creteRow());}
$('#ont-result-content').html('').append(ul);var filter=toInclude.concat(toExclude).join(',');var url='/rest/ajaxhtml/search2';var data={sk:$('#taxonomy').data('sk'),filtersToToggle:filter,tab:'people',resultsperpage:1,availability:'merged',page:'1-200'};$.ajax({url:url,data:data,dataType:'text',cache:false,}).done(function(text){$('#ont-result-content').html(text);taxonomy.adjustLayout();}).fail(function(e){console.error(e);$('#ont-result-content').html('<div class="ont-taxonomy-search-error">ERROR<br/>refresh the page and try again</div>');});};});(function(){function debounce(fn,delay){var timer=0;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
clearTimeout(timer);timer=setTimeout(function(){return fn.apply(void 0,args);},delay);};}
$('#js-ont-layout-section-content').find('.ont-layout-section').first().addClass('inner');function animateWhenScrolled(device){var SHRINK_ANIMATION_DURATION=100;var isShrinked=$('.ont-layout-sticky-header.shrinked').length;var scrollTop=window.pageYOffset||document.documentElement.scrollTop;function animateTop(element,offset,cssStyle){cssStyle=cssStyle||'top';var top=(parseInt($(element).css(cssStyle),10)||0);var newTop=offset+top;var newStyle={};newStyle[cssStyle]=newTop;$(element).animate(newStyle,SHRINK_ANIMATION_DURATION,'swing');}
function animateContent(offset){animateTop('#ont-top-section',offset);animateTop('.ont-header-content-container',offset);animateTop('.js-ont-credit-counter-mobile',offset);animateTop('#ont-result-items-title',offset,'paddingTop');animateTop('#ont-result-content',offset,'paddingTop');$('.ont-layout-sticky-header').toggleClass('shrinked');setTimeout(adjustLayout,300);}
if(isShrinked&&!scrollTop||!isShrinked&&scrollTop){var offset=0;switch(device){case'initial':case'large_desktop':case'desktop':case'large_tablet':break;case'tablet':offset=scrollTop?-23:23;animateContent(offset);break;default:offset=scrollTop?-12:12;animateContent(offset);break;}}}
function adjustLayout(){var device=window.getCurrentMediadevice&&getCurrentMediadevice()||'initial';var headerHeight=$('.ont-layout-sticky-header').outerHeight(true)||0;var creditsCounterHeight=$('.ont-credit-counter-spacer').length?($('.js-ont-credit-counter-mobile').outerHeight(true)||0):0;var topBannerHeight=$('#ont-top-section').outerHeight(true)||0;var resultsHeaderHeight=$('#ont-result-items-title').outerHeight(true)||0;var footerHeight=$('.js-ont-layout-sticky-footer').outerHeight(true)||0;var responsiveFooterHeight=$('.js-ont-responsive-footer').outerHeight(true)||0;var totalHeight=$(window).innerHeight();var contentMargin=parseInt($('#js-ont-layout-section-content').css('margin-top'));if(isNaN(contentMargin)){contentMargin=0;}
switch(device){case'desktop':case'large_desktop':creditsCounterHeight=0;$('.ont-results-fixed-content').css('top',headerHeight+topBannerHeight);var contentHeight=totalHeight-(headerHeight+topBannerHeight+footerHeight);$('#ont-right-section').height(contentHeight);$('#ont-top-section').css('top',headerHeight+creditsCounterHeight);$('#ont-result-content').css('padding-top',resultsHeaderHeight-contentMargin);$('#ont-result-items-title').css('padding-top',0);$('#ont-result-content').css('padding-top',topBannerHeight+resultsHeaderHeight);$('#ont-result-content').css('padding-bottom',footerHeight+10);$('.ont-no-results').css('padding-top',topBannerHeight);break;case'large_tablet':$('.ont-results-fixed-content').css('top',headerHeight);$('#ont-top-section').css('top',headerHeight+creditsCounterHeight);$('#ont-result-items-title').css('padding-top',creditsCounterHeight+topBannerHeight);$('#ont-result-content').css('padding-top',resultsHeaderHeight-contentMargin);$('#ont-result-content').css('padding-bottom',footerHeight+10);$('.ont-no-results').css('padding-top',creditsCounterHeight+topBannerHeight);break;case'initial':case'tablet':case'large_smartphone':case'smartphone':default:footerHeight=0;let searchFormHeight=$('.ont-header-content-container').is(':visible')?$('.ont-header-content-container').height():0;$('.ont-results-fixed-content').css('top',0);$('#ont-top-section').css('top',headerHeight+creditsCounterHeight+searchFormHeight);$('#ont-result-items-title').css('padding-top',headerHeight+creditsCounterHeight+topBannerHeight+searchFormHeight);resultsHeaderHeight=$('#ont-result-items-title').outerHeight(true)||0;$('#ont-result-content').css('padding-top',resultsHeaderHeight-contentMargin);$('#ont-result-content').css('padding-bottom',(footerHeight||responsiveFooterHeight)+10);$('.ont-no-results').css('padding-top',headerHeight+creditsCounterHeight+topBannerHeight);break;}
ontMap.updateMapResults();animateWhenScrolled(device);}
function updateMapBtnCaption(){if($('.js-ont-expand-map-btn').hasClass('collapsed')){$('.js-ont-expand-map-btn').text('Collapse map view');}
else{$('.js-ont-expand-map-btn').text('Expand map view');}}
adjustLayout();$(document).on('media-changed',adjustLayout);$(window).on('resize',debounce(adjustLayout,200));$(window).on('scroll',debounce(adjustLayout,200));$('.js-ont-expand-map-btn').click(function(event){event.preventDefault();$('.js-ont-expand-map-btn').toggleClass('collapsed');$('.ad-placeholder').toggle();$('.js-ont-map-placeholder').toggleClass('full');ontMap.forceResize();updateMapBtnCaption();});var sk=$('#taxonomy').data('sk');function showTaxonomy(){return jQuery.ajax({url:'/rest/json/taxonomy/',data:{sk:sk,tab:'people'},dataType:'json',cache:false,error:function(x,e){console.error(e);},timeout:20000,success:function(data){renderTaxonomy(data,adjustLayout);}});}
$(document).ready(function(){$('#mapApp').trigger('map-rebuild');ontMap.updateMapResults(true);if(sk){showTaxonomy().then(adjustLayout);}});$('.results-occupants, .results-occupants-links').on({mouseenter:function(){$(this).children('.occupants').addClass('hide');$(this).children('.occupants-full').addClass('active');if($(this).children('.occupants-full').height()<$(this).height()){$(this).children('.occupants-full').addClass('height-to-bottom');}},mouseleave:function(){$(this).children('.occupants').removeClass('hide');$(this).children('.occupants-full').removeClass('active');if($(this).children('.occupants-full').hasClass('height-to-bottom')){$(this).children('.occupants-full').removeClass('height-to-bottom');}}});$('p.ont-accordion').on('click',function(){var headerHeight=$('.ont-layout-sticky-header').outerHeight(true);var resultsHeaderHeight=$('#ont-result-items-title').outerHeight(true);var taxonomyWrapper=$('.ont-taxonomy-wrapper').outerHeight(true);$('#ont-result-content').css('padding-top',headerHeight+resultsHeaderHeight-taxonomyWrapper);});}());$(document).ready(function(){var jsUGCRegFrame=$('.jsUGCRegFrame');if(jsUGCRegFrame.length>0){iframeLoader('registrationFrame','/ugc/registration/register/','');}
$('.js-ont-reg-frame').mousedown(function(e){e.preventDefault();var detailsLink=$(this).attr('href');iframeLoader('registrationFrame','/registration/register/',detailsLink);});});function iframeLoader(id,url,detailsLink){var frame=$('<iframe scrolling="no" frameborder="0" id="registrationFrame" name="registrationFrame"  />'),overlay=$('<div id="jsOverlay" />');var $document=$(document.body),iframe=$("#registrationFrame");if(!iframe.length){$document.append(overlay);$document.append(frame);}else{$("#jsOverlay").show();iframe.show();iFramePosition();}
$(frame).attr('src',url);iFramePosition=function(){var leftPos=0;var topPos=0;var windowWidth=$(window).width();var windowHeight=$(window).height();var iFrame=$("#registrationFrame");if(windowWidth<=610||windowHeight<=460){iFrame.css('width',windowWidth);iFrame.css('height',windowHeight);iFrame.contents().find('.regWrapper').css('height',windowHeight-10);}else{iFrame.css('width',610);iFrame.contents().find('.regWrapper').css('height','auto');var iFrameHeight=iFrame.contents().find('.regWrapper').height()+30;iFrame.css('height',iFrameHeight);leftPos=(windowWidth-610)/2;topPos=(windowHeight-iFrameHeight)/2;}
iFrame.css('left',leftPos);iFrame.css('top',topPos);$(document).scrollTop(0,0);};$(window).on("resize orientationchange",function(){iFramePosition();});$('#registrationFrame').load(function(){this.style.height=this.contentWindow.document.body.scrollHeight+'px';window.frames.registrationFrame.$('.regWrapper').addClass('ont-bd-registration-frame');var dLink=detailsLink;window.frames.registrationFrame.signedIn(dLink);iFramePosition();});}